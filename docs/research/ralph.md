# Ralph: AI Coding Agent Loop Technique

> Source: [ghuntley.com/ralph](https://ghuntley.com/ralph/) by Geoffrey Huntley (14 Jul 2025)

## Overview

Ralph is a technique for automating software development using AI coding agents in a continuous loop. Named after the Simpsons character, it represents a simple but effective approach to greenfield project development.

## The Core Loop

In its simplest form, Ralph is a bash loop:

```bash
while :; do cat PROMPT.md | claude-code ; done
```

## Key Principles

### Monolithic Architecture
- Ralph operates as a single process in a single repository
- Avoids multi-agent complexity (like microservices for agents)
- Scales vertically rather than horizontally

### One Task Per Loop
- Each loop iteration should focus on one thing only
- Trust the LLM to determine what's most important to implement
- Narrow scope prevents context window exhaustion

### Deterministic Stack Allocation
- Load the same context every loop: plan file and specifications
- Specs are formed through initial conversations with the agent
- Write specs to files before implementation begins

### Context Window Management
- ~170k usable context window
- Minimize allocation to preserve quality
- Use subagents for expensive operations (file search, summarization)
- Primary context window acts as a scheduler

### Subagent Usage
- Fan out to subagents for parallel work
- Limit parallelism for validation (e.g., only 1 subagent for build/tests)
- Prevents backpressure issues

## Prompt Techniques

### Prevent Assumptions
```
Before making changes search codebase (don't assume not implemented) using subagents. Think hard.
```

### Prevent Placeholder Implementations
```
DO NOT IMPLEMENT PLACEHOLDER OR SIMPLE IMPLEMENTATIONS. WE WANT FULL IMPLEMENTATIONS.
```

### Capture Test Reasoning
Document why tests exist for future loop iterations that won't have the original reasoning context.

### Self-Improvement
Allow Ralph to update documentation (AGENT.md) when discovering new information about the project.

### Bug Documentation
```
For any bugs you notice, document them in @fix_plan.md to be resolved using a subagent
```

## Two Phases

### Phase 1: Generate
- Code generation is cheap
- Control output via technical standards and specifications
- Wrong patterns = update standard library
- Wrong features = fix specifications

### Phase 2: Backpressure
- Validation ensures correct generation
- Wire in: type systems, tests, security scanners, static analyzers
- Fast feedback loop is critical
- After changes, run tests for that specific unit

## The TODO List (fix_plan.md)

- Maintains prioritized list of remaining work
- Generated by dedicated planning loops
- Deleted and regenerated when Ralph goes off track
- Separates planning mode from building mode

## Recovery Strategies

- Broken codebase: evaluate git reset vs. rescue prompts
- Context overflow: use external LLM (Gemini) to create plans
- Commit on green: auto-commit and tag when tests pass

## Expectations

- Works best for greenfield projects
- Expect ~90% completion with the technique
- Senior engineering expertise still required for guidance
- Ralph will produce broken builds sometimes
- Issues can be resolved through different prompt series

## Loop Back Pattern

Program in ways that enable self-evaluation:
- Add logging for debugging
- Compile and inspect output (e.g., LLVM IR)
- Feed results back into subsequent loops
